<!doctype html>
<html lang="en">

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>NHL Analytics Data Warehouse ¬∑ Project ¬∑ Sami Olavuo</title>
	<meta name="description" content="NHL Analytics Data Warehouse by Sami Olavuo.">
	<meta name="theme-color" content="#ffffff">
	<link rel="stylesheet" href="../assets/css/styles.css">
	<link rel="icon" href="../assets/files/favicon.png">
</head>

<body>
	<header>
		<nav class="container" aria-label="Primary">
			<div class="nav-inner">
				<a class="brand" href="/">Sami Olavuo</a>
				<ul class="nav-menu">
					<li><a href="/about.html">About</a></li>
					<li><a href="/projects.html">Projects</a></li>
				</ul>
			</div>
		</nav>
	</header>

	<main>
		<section class="section">
			<div class="container">
				<h1>NHL Analytics Data Warehouse</h1>
				<p>Python Scraping Pipeline + PostgreSQL Dimensional Model</p>

				<details class="card" open>
					<summary>
						<h3>Details</h3>
					</summary>
					<div class="content">

						<p style="margin: 0 0 8px 0;"><strong>Role:</strong> Data Analyst / Analytics Engineer / Data
							Engineer</p>
						<p style="margin: 0 0 8px 0;"><strong>Domain:</strong> Sports Analytics (NHL)</p>
						<p style="margin: 0 0 16px 0;"><strong>Stack:</strong> Python ¬∑ PostgreSQL ¬∑ DBeaver ¬∑ SQL ¬∑ NHL
							API</p>

						<p style="margin: 0 0 4px 0;">
							üîó <a href="https://github.com/sampo50/nhl_db" style="margin-right: 16px;">[GitHub repo /
								Scripts]</a>
						</p>
						<p style="margin: 0 0 4px 0;">
							üîó <a
								href="/Users/samiolavuo/Documents/GitHub/samiolavuo.com/assets/files/sql_data_architecture.drawio.png"
								style="margin-right: 16px;">[ERD Diagram]</a>
						</p>
						<p style="margin: 0 0 4px 0;">
							üîó <a
								href="/Users/samiolavuo/Documents/GitHub/samiolavuo.com/assets/files/sql_datawarehouse_looker_dashboard.png"
								style="margin-right: 16px;">[SQL DDL Scripts]</a>
						</p>
						<p style="margin: 0 0 4px 0;">
							üîó <a href="#" style="margin-right: 16px;">[Python Scraper Code]</a>
						</p>
					</div>
				</details>

				<div class="grid" style="grid-template-columns: 1fr; gap: 12px;">
					<details class="card" open>
						<summary>
							<h3>Summary</h3>
						</summary>
						<div class="content">
							<details class="card" open>
								<summary>
									<h4>Executive Summary</h4>
								</summary>
								<div class="content">
									<p>This project implements a full NHL analytics data warehouse by scraping official
										NHL data using Python and modeling it into a PostgreSQL dimensional warehouse.
									</p>
									<br>
									<p>The solution combines API ingestion, data normalization, surrogate key modeling,
										and multi-grain fact tables to enable advanced hockey analytics at player, team,
										game, and event levels.</p>
									<br>
									<p>The warehouse is designed to support both BI reporting and advanced analytical
										modeling.</p>
								</div>
							</details>

							<details class="card" open>
								<summary>
									<h4>Business Goal</h4>
								</summary>
								<div class="content">
									<p>Public NHL data is available, but:</p>

									<ul style="margin-left: 38px; margin-bottom: 16px; margin-top: 16px;">
										<li>It is fragmented across multiple API endpoints</li>
										<li>Player identities are inconsistent between sources</li>
										<li>Analytical queries become complex without proper modeling</li>
									</ul>

									<p>This project solves those problems by:</p>

									<ul style="margin-left: 38px; margin-bottom: 16px; margin-top: 16px;">
										<li>Normalizing NHL API data into a structured warehouse</li>
										<li>Preserving raw detail while enabling analytical performance</li>
										<li>Enabling scalable analytics without re-scraping data</li>
									</ul>
								</div>
							</details>

							<details class="card" open>
								<summary>
									<h4>Architecture Overview</h4>
								</summary>
								<div class="content">
									<p><strong>Data Pipeline</strong></p>

									<p style="margin-left: 38px; margin-bottom: 16px; margin-top: 38px;">NHL API</p>
									<p style="margin-left: 38px; margin-bottom: 16px; margin-top: 16px;">‚Üì</p>
									<p style="margin-left: 38px; margin-bottom: 16px; margin-top: 16px;">Python Scrapers
										(nhlpy + psycopg2)</p>
									<p style="margin-left: 38px; margin-bottom: 16px; margin-top: 16px;">‚Üì</p>
									<p style="margin-left: 38px; margin-bottom: 16px; margin-top: 16px;">PostgreSQL Data
										Warehouse (nhl_dw schema)</p>
									<p style="margin-left: 38px; margin-bottom: 16px; margin-top: 16px;">‚Üì</p>
									<p style="margin-left: 38px; margin-bottom: 38px; margin-top: 16px;">SQL Analytics /
										BI / Python Analysis</p>
								</div>
							</details>

							<details class="card" open>
								<summary>
									<h4>Warehouse Design</h4>
								</summary>
								<div class="content">
									<p style="margin-bottom: 16px; margin-top: 16px;">The warehouse follows dimensional
										modeling best practices.</p>

									<h4 style="margin-top: 24px;">Dimensions</h4>

									<dl class="dw-list">
										<dt>Table</dt>
										<dd>Purpose</dd>

										<dt><code>dim_date</code></dt>
										<dd>Calendar attributes</dd>

										<dt><code>dim_player</code></dt>
										<dd>Player master data</dd>

										<dt><code>dim_team</code></dt>
										<dd>NHL teams</dd>

										<dt><code>dim_season</code></dt>
										<dd>NHL seasons</dd>

									<dt><code>dim_venue</code></dt>
									<dd>Game venues</dd>
								</dl>

								<h4 style="margin-top: 24px;">Fact Tables</h4>

								<dl class="dw-list">
									<dt>Table</dt>
									<dd>Grain</dd>

									<dt><code>fact_game</code></dt>
									<dd>One row per NHL game</dd>

									<dt><code>fact_team_game</code></dt>
									<dd>One row per team per game</dd>

									<dt><code>fact_skater_game</code></dt>
									<dd>One row per skater per game</dd>

									<dt><code>fact_goalie_game</code></dt>
									<dd>One row per goalie per game</dd>

									<dt><code>event_play</code></dt>
									<dd>One row per play event</dd>
								</dl>

								<p style="margin-top: 38px;"><strong>Modeling Principles</strong></p>
								<ul style="margin-left: 38px; margin-bottom: 16px; margin-top: 16px;">
									<li>Surrogate keys for all dimensions</li>
									<li>Natural keys enforced as UNIQUE</li>
									<li>Referential integrity with foreign keys</li>
									<li>Correct analytical grain per fact table</li>
									<li>Event-level JSON retained for extensibility</li>
								</ul>
								</div>
							</details>

							<details class="card" open>
								<summary>
									<h4>Python Scraping Layer</h4>
								</summary>
								<div class="content">
									<p style="margin-top: 16px;">The ingestion layer is built in Python
										using <span class="glass-card">nhlpy</span>
										 and <span class="glass-card">psycopg2</span>.</p>
									<p style="margin-top: 16px;"><strong>Key design choices</strong></p>

									<ul style="margin-left: 38px; margin-bottom: 16px; margin-top: 16px;">
										<li>Combines roster and stats endpoints to guarantee player completeness</li>
										<li>Normalizes inconsistent API payloads</li>
										<li>Uses UPSERT logic to prevent duplication</li>
										<li>Preserves existing data while enriching missing attributes</li>
									</ul>

									<p style="margin-top: 16px;"><strong>Example logic</strong></p>

									<ul style="margin-left: 38px; margin-bottom: 16px; margin-top: 16px;">
										<li>Roster data provides best biographical attributes</li>
										<li>Stats data ensures coverage for all players with recorded games</li>
										<li>Both feed into a single normalized player dimension</li>
									</ul>

									<p>This ensures no players are lost due to API fragmentation.</p>
								</div>
							</details>

							<details class="card" open>
								<summary>
									<h4>Data Quality Strategy</h4>
								</summary>
								<div class="content">
									<ul style="margin-left: 38px; margin-bottom: 16px; margin-top: 16px;">
										<li>Surrogate keys isolate warehouse logic from API volatility</li>
										<li>Natural keys enforce uniqueness</li>
										<li>Event data stored in JSON for future enrichment</li>
										<li>Deduplication handled during ingestion</li>
									</ul>
								</div>
							</details>

							<details class="card" open>
								<summary>
									<h4>Analytical Use Cases</h4>
								</summary>
								<div class="content">
									<p>This warehouse enables:</p>

									<ul style="margin-left: 38px; margin-bottom: 16px; margin-top: 16px;">
										<li>Player performance analysis</li>
										<li>Goalie vs skater efficiency comparison</li>
										<li>Team trends by season and opponent</li>
										<li>Event heatmaps and shot locations</li>
										<li>Advanced derived metrics (xG, clutch, possession, etc.)</li>
										<li>BI dashboards and Python analytics</li>
									</ul>
								</div>
							</details>

							<details class="card" open>
								<summary>
									<h4>Example Queries</h4>
								</summary>
								<div class="content">
									<p>Typical analytical questions supported:</p>

									<ul style="margin-left: 38px; margin-bottom: 16px; margin-top: 16px;">
										<li>Top goal scorers by season and team</li>
										<li>Goalie save percentage trends</li>
										<li>Player shot efficiency</li>
										<li>Team power play efficiency</li>
										<li>Event distribution by zone</li>
									</ul>
								</div>
							</details>

							<details class="card" open>
								<summary>
									<h4>Limitations</h4>
								</summary>
								<div class="content">
									<ol style="margin-left: 38px; margin-bottom: 16px; margin-top: 16px;">
										<li style="margin-bottom: 16px;"><strong>Layer separation prevents ‚Äúbusiness
												logic drift‚Äù</strong><br>Raw ingestion stays stable while
											transformations evolve safely in Silver and Gold.</li>
										<li style="margin-bottom: 16px;"><strong>Gold-layer star schema reduces
												downstream complexity</strong><br>BI and analysts share one consistent
											definition of metrics and dimensions.</li>
										<li><strong>Standardization in Silver is the scaling lever</strong><br>Conformed
											keys and canonical attributes enable new marts with minimal rework.</li>
									</ol>
								</div>
							</details>

							<details class="card" open>
								<summary>
									<h4>Planned Extensions</h4>
								</summary>
								<div class="content">
									<p><strong>Planned upgrades</strong></p>

									<ul style="margin-left: 38px; margin-bottom: 16px; margin-top: 16px;">
										<li>Automated data quality checks (freshness, row counts, uniqueness,
											referential integrity)</li>
										<li>Improved incremental loading patterns and change tracking</li>
										<li>Orchestration/scheduling and version-controlled SQL migrations</li>
										<li>Optional semantic layer standardization for BI metric governance</li>
									</ul>
								</div>
							</details>

						</div>
					</details>
				</div>
			</div>
		</section>
	</main>

	<script src="../assets/js/main.js"></script>
</body>

</html>